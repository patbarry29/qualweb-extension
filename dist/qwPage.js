var QWPage;QWPage=(()=>{"use strict";var e={26:e=>{e.exports=class{constructor(){this.cache=new Map}get(e){return this.cache.get(e)}put(e,t){this.cache.set(e,t)}exists(e){return this.cache.has(e)}}},290:(e,t,n)=>{const s=n(564);e.exports=class{constructor(e){this.pseudoSelectors=["focus","hover","before","after","active","disabled","checked","empty","enabled","in-range","invalid","lang","link","optional","out-of-range","read-only","read-write","required","target","valid","visited","first-letter","first-line","selection"],this.elementsCSSRules=new Map,this.document=e}map(){return this.mapExternalStylesheets(),this.mapHeadStyles(),this.mapInlineStyles(),this.elementsCSSRules}mapExternalStylesheets(){var e;for(const t of this.document.styleSheets||[])if("link"===(null===(e=t.ownerNode)||void 0===e?void 0:e.nodeName.toLowerCase())){const e=this.getCSSRules(t);for(const n of e||[])1===n.type?this.mapNormalCSSRule(n,void 0,"file",t.href):4===n.type&&this.mapMediaCSSRule(n,"file",t.href)}}mapHeadStyles(){const e=this.document.querySelectorAll("style");for(const t of e||[]){const e=this.getCSSRules(t.sheet);for(const n of e||[])1===n.type?this.mapNormalCSSRule(n,void 0,"head",new s.QWElement(t).getElementSelector()):4===n.type&&this.mapMediaCSSRule(n,"head",new s.QWElement(t).getElementSelector())}}mapInlineStyles(){const e=this.document.querySelectorAll("[style]");for(const t of e||[]){const e=t.getAttribute("style");if(e){const n=e.split(";").map((e=>e.trim())).filter((e=>""!==e))||[e.trim()];this.elementsCSSRules.has(t)?this.addElementCSSRules(t,n,void 0,void 0,"inline",new s.QWElement(t).getElementSelector()||""):this.createElementCSSMapping(t,n,void 0,void 0,"inline",new s.QWElement(t).getElementSelector()||"")}}}mapMediaCSSRule(e,t,n){const s=e.cssRules||new CSSRuleList;for(const l of s||[])1===l.type&&this.mapNormalCSSRule(l,e.conditionText,t,n)}mapNormalCSSRule(e,t,n,s){const l=e.selectorText.trim(),r=e.cssText.replace(l,"").replace("{","").replace("}","").trim().split(";").map((e=>e.trim())).filter((e=>""!==e)),o=l.split(",")||[l];for(let e of o||[]){let l;if(e.includes("::")){const t=e.split("::");this.pseudoSelectors.includes(t[1])&&(e=t[0].trim(),l="::"+t[1].trim())}else if(e.includes(":")){const t=e.split(":");e=t[0].trim(),l=":"+t[1].trim()}const o=this.getElements(e);for(const e of o||[])this.elementsCSSRules.has(e)?this.addElementCSSRules(e,r,t,l,n,s||""):this.createElementCSSMapping(e,r,t,l,n,s||"")}}createElementCSSMapping(e,t,n,s,l,r){const o={};n&&(o.media={},o.media[n]={},s&&(o.media[n][s]={}));for(const e of t||[]){const t=e.split(":")[0].trim();n?s?o.media[n][s][t]=this.createPropertyObject(e,l,r):o.media[n][t]=this.createPropertyObject(e,l,r):void 0===o[t]?o[t]=this.createPropertyObject(e,l,r):o[t].important?e.includes("!important")&&(o[t]=this.createPropertyObject(e,l,r)):o[t]=this.createPropertyObject(e,l,r)}this.elementsCSSRules.set(e,o)}addElementCSSRules(e,t,n,s,l,r){for(const o of t||[]){const t=this.elementsCSSRules.get(e),i=o.split(":")[0].trim();n?(void 0===t.media&&(t.media={}),void 0===t.media[n]?(t.media[n]={},s?(t.media[n][s]={},t.media[n][s][i]=this.createPropertyObject(o,l,r)):t.media[n][i]=this.createPropertyObject(o,l,r)):s?void 0===t.media[n][s]?(t.media[n][s]={},t.media[n][s][i]=this.createPropertyObject(o,l,r)):void 0===t.media[n][s][i]?t.media[n][s][i]=this.createPropertyObject(o,l,r):t.media[n][s][i].important?o.includes("!important")&&(t.media[n][s][i]=this.createPropertyObject(o,l,r)):t.media[n][s][i]=this.createPropertyObject(o,l,r):void 0===t.media[n][i]?t.media[n][i]=this.createPropertyObject(o,l,r):t.media[n][i].important?o.includes("!important")&&(t.media[n][i]=this.createPropertyObject(o,l,r)):t.media[n][i]=this.createPropertyObject(o,l,r)):s?void 0===t[s]?(t[s]={},t[s][i]=this.createPropertyObject(o,l,r)):void 0===t[s][i]?t[s][i]=this.createPropertyObject(o,l,r):t[s][i].important?o.includes("!important")&&(t[s][i]=this.createPropertyObject(o,l,r)):t[s][i]=this.createPropertyObject(o,l,r):void 0===t[i]?t[i]=this.createPropertyObject(o,l,r):t[i].important?o.includes("!important")&&(t[i]=this.createPropertyObject(o,l,r)):t[i]=this.createPropertyObject(o,l,r),this.elementsCSSRules.set(e,t)}}createPropertyObject(e,t,n){const s=e.includes("!important"),l=e.split(":"),r=l[0].trim(),o=l.splice(1).join("");return{important:s,name:r,value:s?o.replace("!important","").trim():o.trim(),location:t,pointer:n}}getCSSRules(e){try{return(null==e?void 0:e.rules)||(null==e?void 0:e.cssRules)||null}catch(e){return null}}getElements(e){try{return this.document.querySelectorAll(e)}catch(e){return null}}}},590:function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.QWPage=void 0;const l=n(564),r=s(n(26)),o=s(n(290)),i=s(n(597));class m{constructor(e,t,n){this.document=e,this.cache=new r.default,this.extraDocuments=new Map,this.window=t,new i.default(e).processElementSelector(),n&&(this.elementsCSSRules=new o.default(this.document).map()),this.url=this.document.baseURI,this.processIframes(),this.processShadowDom()}processShadowDom(){const e=this.document.querySelectorAll("*");for(const t of e||[])if(null!==t.shadowRoot){t.innerHTML="";const e=new l.QWElement(t).getElementSelector(),n=new m(t.shadowRoot,this.window,!0);this.extraDocuments.set(e,n)}}processIframes(){const e=this.document.querySelectorAll("iframe");for(const t of e||[])try{const e=new l.QWElement(t),n=e.getContentFrame();if(n&&n.defaultView){const t=e.getElementSelector(),s=new m(n,n.defaultView,!0);this.extraDocuments.set(t,s)}}catch(e){}}addCSSRulesPropertyToElement(e){var t;e&&(null===(t=this.elementsCSSRules)||void 0===t?void 0:t.has(e))&&e.setAttribute("_cssRules","true")}addIframeAttribute(e,t){for(const n of e)n.setElementAttribute("_documentSelector",t)}cacheValue(e,t,n){this.cache.put(e+","+t,n)}getCachedValue(e,t){return this.cache.get(e+","+t)}isValueCached(e,t){return this.cache.exists(e+","+t)}getURL(){return this.url}getElementFromDocument(e){const t=this.document.querySelector(e);return this.addCSSRulesPropertyToElement(t),t?new l.QWElement(t,this.elementsCSSRules):null}getElementsFromDocument(e){const t=this.document.querySelectorAll(e),n=new Array;for(const e of t||[])this.addCSSRulesPropertyToElement(e),n.push(new l.QWElement(e,this.elementsCSSRules));return n}getElement(e,t){let n=null,s=null;if(t)if(s=t.getElementAttribute("_documentSelector"),s&&this.extraDocuments.has(s)){const l=this.extraDocuments.get(s);l&&(n=l.getElement(e,t))}else n=this.getElementFromDocument(e);else if(n=this.getElementFromDocument(e),!n){const t=Array.from(this.extraDocuments.keys());let l=0;for(;!n&&l<t.length;){const r=this.extraDocuments.get(t[l]);r&&(n=r.getElement(e),s=t[l],l++)}}return n&&s&&this.addIframeAttribute([n],s),n}getElements(e,t){const n=new Array;if(t){const s=t.getElementAttribute("_documentSelector");if(s&&this.extraDocuments.has(s)){const l=this.extraDocuments.get(s);l&&(n.push(...l.getElements(e,t)),this.addIframeAttribute(n,s))}else n.push(...this.getElementsFromDocument(e))}else{n.push(...this.getElementsFromDocument(e));const t=Array.from(this.extraDocuments.keys());let s,l,r=0;for(;r<t.length;)s=this.extraDocuments.get(t[r]),s&&(l=s.getElements(e),this.addIframeAttribute(l,t[r]),n.push(...l),r++)}return n}getElementByID(e){const t=this.document.querySelector(`[id='${e}']`);return this.addCSSRulesPropertyToElement(t),t?new l.QWElement(t,this.elementsCSSRules):null}getElementByAttributeName(e){const t=this.document.querySelector(`[name='${e}']`);return this.addCSSRulesPropertyToElement(t),t?new l.QWElement(t,this.elementsCSSRules):null}getPageRootElement(){if(this.document instanceof Document){const e=this.document.documentElement;return this.addCSSRulesPropertyToElement(e),e?new l.QWElement(e,this.elementsCSSRules):null}return null}getHTMLContent(){return this.document instanceof ShadowRoot?this.document.innerHTML:this.document.documentElement.outerHTML}getFocusedElement(){const e=this.document.activeElement;return this.addCSSRulesPropertyToElement(e),e?new l.QWElement(e,this.elementsCSSRules):null}cleanAllElements(){const e=this.document.querySelector("html");if(e){e.removeAttribute("_selector"),e.removeAttribute("_cssRules"),e.removeAttribute("_documentSelector");const t=e.children;t&&this.cleanAllElementsAux([...t])}}cleanAllElementsAux(e){for(const t of e||[]){t.removeAttribute("_selector"),t.removeAttribute("_cssRules"),t.removeAttribute("_documentSelector");const e=t.children;e&&e.length>0&&this.cleanAllElementsAux([...e])}}}t.QWPage=m},597:e=>{e.exports=class{constructor(e){this.document=e}processElementSelector(){const e=this.document.querySelector("html");if(e){e.setAttribute("_selector","html");const t=e.children;t&&this.processElementSelectorAux([...t])}}processElementSelectorAux(e){const t=e[0].parentElement;if(t){const n=t.getAttribute("_selector");if(n){this.addSelectorAttribute(e,n);for(const t of e){const e=t.children;e&&e.length>0&&this.processElementSelectorAux([...e])}}}}addSelectorAttribute(e,t){let n,s=1;for(const l of e)n=l.tagName.toLowerCase(),l.setAttribute("_selector",t+" > "+n+":nth-child("+s+")"),s++}}},564:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.QWElement=void 0;class n{constructor(e,t){this.element=e,this.elementsCSSRules=t,this.selector="";let n=e.getAttribute("_selector");n&&(this.selector=n)}addCSSRulesPropertyToElement(e){var t;e&&(null===(t=this.elementsCSSRules)||void 0===t?void 0:t.has(e))&&e.setAttribute("_cssRules","true")}hasCSSRules(){return"true"===this.element.getAttribute("_cssRules")}getCSSRules(){var e;return null===(e=this.elementsCSSRules)||void 0===e?void 0:e.get(this.element)}hasCSSProperty(e,t,n){var s,l;if(null===(s=this.elementsCSSRules)||void 0===s?void 0:s.has(this.element)){const s=null===(l=this.elementsCSSRules)||void 0===l?void 0:l.get(this.element);return t&&n?void 0!==s.media[n][t][e]:t?void 0!==s[t][e]:n?void 0!==s.media[n][e]:void 0!==s[e]}return!1}getCSSProperty(e,t,n){var s,l;if(null===(s=this.elementsCSSRules)||void 0===s?void 0:s.has(this.element)){const s=null===(l=this.elementsCSSRules)||void 0===l?void 0:l.get(this.element);return t&&n?s.media[n][t][e]:t?s[t][e]:n?s.media[n][e]:s[e]}}getCSSMediaRules(){var e,t;if(null===(e=this.elementsCSSRules)||void 0===e?void 0:e.has(this.element))return(null===(t=this.elementsCSSRules)||void 0===t?void 0:t.get(this.element)).media}getCSSPseudoSelectorRules(e){var t,n;if(null===(t=this.elementsCSSRules)||void 0===t?void 0:t.has(this.element))return(null===(n=this.elementsCSSRules)||void 0===n?void 0:n.get(this.element))[e]}elementHasAttribute(e){return this.element.getAttributeNames().includes(e)}elementHasAttributes(){return this.element.getAttributeNames().length>0}elementHasChild(e){for(const t of this.element.children||[])if(t.tagName.toLowerCase()===e.toLowerCase())return!0;return!1}elementHasChildren(){return this.element.children.length>0}elementHasParent(e){const t=this.element.parentElement;return!!t&&t.tagName.toLowerCase()===e.toLowerCase()}hasTextNode(){var e;let t=!1;for(const n of this.element.childNodes||[])3===n.nodeType&&""!==(null===(e=n.textContent)||void 0===e?void 0:e.trim())&&(t=!0);return t}getElementAttribute(e){return this.element.getAttribute(e)}getElementAttributes(){const e={};for(const t of this.element.getAttributeNames()||[])e[t]=this.element.getAttribute(t);return e}getElementAttributesName(){return this.element.getAttributeNames()}getElementChildren(){const e=this.getElementSelector(),t=new Array;try{const s=this.element.querySelectorAll(e+" > *");for(const e of s||[])this.addCSSRulesPropertyToElement(e),t.push(new n(e,this.elementsCSSRules))}catch(e){}return t}getElementChildTextContent(e){for(const t of this.element.children||[])if(t.tagName.toLowerCase()===e.toLowerCase())return t.textContent||void 0}getElementHtmlCode(e,t){let n,s=this.element.getAttribute("_cssRules"),l=this.element.getAttribute("_selector"),r=this.element.getAttribute("_documentSelector");if(this.element.removeAttribute("_cssRules"),this.element.removeAttribute("_selector"),this.element.removeAttribute("_documentSelector"),t){const e=this.getElementSelector();let t=this.element.querySelectorAll(e+" *"),s=[];for(let e of t){let t=e.getAttribute("_cssRules"),n=e.getAttribute("_selector"),l=e.getAttribute("_documentSelector");s.push({cssRulesValue:t,selectorValue:n,documentSelectorValue:l}),e.removeAttribute("_cssRules"),e.removeAttribute("_selector"),e.removeAttribute("_documentSelector")}n=this.element.outerHTML;let l=0;for(const e of t){const t=s[l];t.cssRulesValue&&e.setAttribute("_cssRules",t.cssRulesValue),t.selectorValue&&e.setAttribute("_selector",t.selectorValue),t.documentSelectorValue&&e.setAttribute("_documentSelector",t.documentSelectorValue),l++}}else if(e){let e=this.element.cloneNode(!1);const t=this.getElementText();e.innerHTML=void 0!==t?t:"",n=e.outerHTML}else{const e=this.element.cloneNode(!1);e.innerHTML="",n=e.outerHTML}return s&&this.element.setAttribute("_cssRules",s),l&&this.element.setAttribute("_selector",l),r&&this.element.setAttribute("_documentSelector",r),n}getElement(e){const t=this.element.querySelector(e);return this.addCSSRulesPropertyToElement(t),this.convertElementToQWElement(t)}convertElementToQWElement(e){return e?(this.addCSSRulesPropertyToElement(e),new n(e,this.elementsCSSRules)):null}convertElementsToQWElement(e){const t=new Array;for(const s of e||[])this.addCSSRulesPropertyToElement(s),t.push(new n(s,this.elementsCSSRules));return t}getElements(e){return this.convertElementsToQWElement(this.element.querySelectorAll(e))}getElementNextSibling(){return this.convertElementToQWElement(this.element.nextElementSibling)}getElementParent(){return this.convertElementToQWElement(this.element.parentElement)}getParentAllContexts(){let e=this.element.parentElement;if(!e){let t=this.element.getAttribute("_documentSelector");t&&(e=document.querySelector(t))}return this.convertElementToQWElement(this.element.parentElement)}getElementPreviousSibling(){return this.convertElementToQWElement(this.element.previousElementSibling)}getElementProperty(e){const t=this.element[e];return null===t?"":t}getElementSelector(){if(""===this.selector){if("html"===this.element.tagName.toLowerCase())return"html";if("head"===this.element.tagName.toLowerCase())return"html > head";if("body"===this.element.tagName.toLowerCase())return"html > body";let e="";const t=new Array;let n=this.element.parentElement;for(;n;)t.unshift(this.getSelfLocationInParent(n)),n=n.parentElement;t.length>0?(e+=t.join(" > "),e+=" > "+this.getSelfLocationInParent(this.element)):e+=this.getSelfLocationInParent(this.element);let s=this.element.getAttribute("_documentSelector");return s&&(e=s+e),this.selector=e,e}return this.selector}getSelfLocationInParent(e){let t="";if("body"===e.tagName.toLowerCase()||"head"===e.tagName.toLowerCase())return e.tagName.toLowerCase();let n=0,s=e.previousElementSibling;for(;s;)s.tagName.toLowerCase()===e.tagName.toLowerCase()&&n++,s=s.previousElementSibling;return t+=`${e.tagName.toLowerCase()}:nth-of-type(${n+1})`,t}getElementStyleProperty(e,t){return getComputedStyle(this.element,t).getPropertyValue(e)}getElementTagName(){return this.element.tagName.toLowerCase()}getElementText(){let e;e=this.element.shadowRoot?this.element.shadowRoot.childNodes:this.element.childNodes;let t,n="";for(const s of e||[])t=s.textContent,3===s.nodeType&&t&&""!==t.trim()&&(n+=t.trim());return n||(n=""),n}getElementType(){return 1===this.element.nodeType?"tag":2===this.element.nodeType?"attribute":3===this.element.nodeType?"text":"comment"}getNumberOfSiblingsWithTheSameTag(){let e=1,t=this.element.nextElementSibling;for(;t;)"a"===t.tagName.toLowerCase()&&e++,t=t.nextElementSibling;return e}setElementAttribute(e,t){this.element.setAttribute(e,t)}concatANames(e){const t=this.element.childNodes;let n,s="",l=0,r=0;for(const o of t||[])n=o.textContent,3===o.nodeType&&n&&""!==n.trim()?(s=s+(0===r?"":" ")+n.trim(),r++):1===o.nodeType&&(s=s+(r>0&&e[l]?" ":"")+e[l],l++);return s||(s=""),s}isOffScreen(){const e=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight),t=Math.max(document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth,document.body.clientWidth,document.documentElement.clientHeight),n=this.element.getBoundingClientRect(),s=n.left,l=n.right,r=n.bottom,o=n.top,i=this.noParentScrolled(r);return s>t||l<0||r<0&&i||o>e||0===l&&0===s}isElementHTMLElement(){return this.element instanceof HTMLElement}getContentFrame(){let e=null;if("iframe"===this.getElementTagName()){const t=this.element.contentWindow;t&&(e=t.document)}return e}elementHasTextNode(){return null!==this.element.firstChild&&3===this.element.firstChild.nodeType}noParentScrolled(e){let t=this.element.parentElement;for(;t&&"html"!==t.nodeName.toLowerCase();){if(t.scrollTop&&(e+=t.scrollTop)>=0)return!1;t=t.parentElement}return!0}focusElement(){this.element.focus()}getBoundingBox(){return this.element.getBoundingClientRect()}getShadowElement(e){const t=this.element.shadowRoot;let n=null;return t&&(n=t.querySelector(e)),this.convertElementToQWElement(n)}getShadowElements(e){const t=this.element.shadowRoot;let n=null;return t&&(n=t.querySelectorAll(e)),this.convertElementsToQWElement(n)}}t.QWElement=n}},t={};return function n(s){if(t[s])return t[s].exports;var l=t[s]={exports:{}};return e[s].call(l.exports,l,l.exports,n),l.exports}(590)})();